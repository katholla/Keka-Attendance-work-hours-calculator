<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Work Hours Calculator</title>
    <style>
        body {
            font-family: "Segoe UI", Arial, sans-serif;
            margin: 0;
            padding: 20px;
            background: #f4f6f9;
            color: #333;
        }

        h2 {
            text-align: center;
            color: #2c3e50;
        }

        .container {
            max-width: 600px;
            margin: auto;
            background: #fff;
            padding: 20px 25px;
            border-radius: 10px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }

        textarea {
            width: 100%;
            height: 180px;
            padding: 10px;
            font-size: 14px;
            border-radius: 6px;
            border: 1px solid #ccc;
            resize: vertical;
            margin-bottom: 15px;
        }

        button {
            width: 100%;
            background: #3498db;
            color: #fff;
            border: none;
            padding: 12px;
            font-size: 16px;
            border-radius: 6px;
            cursor: pointer;
            transition: 0.3s;
        }

            button:hover {
                background: #2980b9;
            }

        .result {
            margin-top: 15px;
            padding: 15px;
            border-radius: 8px;
            font-size: 15px;
            line-height: 1.6;
        }

        .success {
            background: #eafaf1;
            border: 1px solid #2ecc71;
            color: #27ae60;
        }

        .warning {
            background: #fff4e6;
            border: 1px solid #f39c12;
            color: #d35400;
        }

        .highlight {
            font-weight: bold;
            color: #c0392b;
        }
    </style>
</head>
<body>
    <h2>Work Hours Calculator</h2>
    <div class="container">
        <p>Enter your IN/OUT swipes from Keka-Attendance Logs as is:</p>

        <textarea id="timeInput" placeholder="Example:
10:00:00 AM
1:00:00 PM
2:00:00 PM
4:00:00 PM
4:20:00 PM
7020:00 PM"></textarea>

        <button onclick="calculateHours()">Calculate</button>

        <div class="result" id="output"></div>
    </div>

    <script>
        function parseTime12(t) {
            if (t.toUpperCase() === "MISSING") return null;
            let [time, meridian] = t.split(" ");
            let [h, m, s] = time.split(":").map(Number);
            if (meridian.toUpperCase() === "PM" && h !== 12) h += 12;
            if (meridian.toUpperCase() === "AM" && h === 12) h = 0;
            return h * 3600 + m * 60 + s;
        }

        function formatTime(sec) {
            let h = Math.floor(sec / 3600) % 24;
            let m = Math.floor((sec % 3600) / 60);
            let s = sec % 60;
            let meridian = h >= 12 ? "PM" : "AM";
            h = h % 12 || 12;
            return [h, m, s].map((x, i) => i === 0 ? x : String(x).padStart(2, '0')).join(":") + " " + meridian;
        }

        function calculateHours() {
            let raw = document.getElementById("timeInput").value.trim();
            let output = document.getElementById("output");
            if (!raw) {
                output.className = "result warning";
                output.innerHTML = "⚠️ Please enter some times.";
                return;
            }

            let times = raw.split(/\n/).map(t => t.trim()).filter(Boolean);
            let total = 0;
            let lastIn = null;

            for (let i = 0; i < times.length; i += 2) {
                let start = parseTime12(times[i]);
                let end = parseTime12(times[i + 1] || "MISSING");

                if (start && end) {
                    total += (end - start);
                } else if (start && !end) {
                    lastIn = start;
                }
            }

            let worked = `Total Worked: <b>${Math.floor(total / 3600)}h ${Math.floor((total % 3600) / 60)}m ${(total % 60)}s</b>`;
            let required = 8 * 3600 - total;

            if (required > 0) {
                output.className = "result warning";
                let remain = `Remaining: <span class="highlight">${Math.floor(required / 3600)}h ${Math.floor((required % 3600) / 60)}m ${(required % 60)}s</span>`;
                let exitMsg = lastIn ? `<br>➡️ Exit at: <b>${formatTime(lastIn + required)}</b>` : "";
                output.innerHTML = `⏳ ${worked}<br>${remain}${exitMsg}`;
            } else {
                output.className = "result success";
                output.innerHTML = `🎉 ${worked}<br>You already completed 8 hours! ✅`;
            }
        }
    </script>
</body>
</html>
